<!DOCTYPE html>
<html>
<head><meta charset="utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/js/select2.min.js"></script>

<script>        
function getalbums()
{
artist = $("#artists option:selected").text();
$.ajax({
    url: "{{ host }}/get_collection_albums_json",
    data:{
        artist : $("#artists option:selected").text()
    },
    dataType: "json",
    type: "GET",
    async: true,
    success: function (data) {
        console.log(data);
        var options = "<option>All Albums</option>";
        $.each(data, function (key, value) {
            options += '<option>' + value + '</option>';
        });
        $('#albums option').remove();
        $('#albums').append(options);
    },
    error(jqXHR, textStatus, errorThrown) {
        alert('Something wrong happened because: ' + errorThrown)
    }
});
}
function getqueue()
{
queue= $("#queue option:selected").text();
$.ajax({
    url: "{{ host }}/get_queue_json",
    dataType: "json",
    type: "GET",
    async: true,
    success: function (data) {
        console.log(data);
        var options = "<option>Current Queue</option>";
        $.each(data, function (key, value) {
            options += '<option>' + value + '</option>';
        });
        $('#queue option').remove();
        $('#queue').append(options);
    },
    error(jqXHR, textStatus, errorThrown) {
        alert('Something wrong happened because: ' + errorThrown)
    }
});
}

function getartists()
{
$.ajax({
    url: "{{ host }}/get_collection_artists_json",
    dataType: "json",
    type: "GET",
    async: true,
    success: function (data) {
        console.log(data);
        var options = "<option>All Artists</option>";
        $.each(data, function (key, value) {
            options += '<option>' + value + '</option>';
        });
        $('#artists option').remove();
        $('#artists').append(options);
    },
    error(jqXHR, textStatus, errorThrown) {
        alert('Something wrong happened because: ' + errorThrown)
    }
});
}

$(document).ready(function(){
$('#artists').select2();
$('#albums').select2();
$('#queue').select2();
getartists();
getalbums();
$(".artists").change(getalbums);

$("#RefreshQueue").click(function()
{
    getqueue()
})

$("#AppendToQueue").click(function()
{
    $.ajax({
        type: "GET",
        url: "{{ host }}/append_to_track_queue",
        data:{
            artist : $("#artists option:selected").text(),
            album : $("#albums option:selected").text()
        },
        success: function (data) {
            alert(data);
        }
    });
})

$("#NewQueue").click(function()
{
    $.ajax({
        type: "GET",
        url: "{{ host }}/new_track_queue",
        data:{
            artist : $("#artists option:selected").text(),
            album : $("#albums option:selected").text()
        },
        success: function (data) {
            alert(data);
        },
        error(jqXHR, textStatus, errorThrown) {
            alert('Something wrong happened because: ' + errorThrown)
        }
        });
})

});
</script>
</head>
<body>
<select style="width: 300px" id="artists"></select><br>
<select style="width: 300px" id="albums"></select><br>
<input type="button" id="AppendToQueue" value="Append to Queue">
<input type="button" id="NewQueue" value="Create new Queue">
<p>
    <select style="width: 300px" id="queue"></select><br>
    <input type="button" id="RefreshQueue" value="Refresh Queue">
</p>
</body>
</html>
